# Phase 4 μ™„λ£ μ”μ•½

Phase 4: λ¨λΈ νμΌμ— ν•„λ“ μ¶”κ°€ - μ™„λ£ λ³΄κ³ μ„

---

## β… μ™„λ£λ μ‘μ—…

### Step 1: λ¨λΈ νμΌ μμ •

#### 1. `server/models/keyMapping.js`
**μ¶”κ°€λ ν•„λ“**:
- `synthSettings` (JSON, NULL ν—μ©)
  - Tone.js μ‹ μ„μ‚¬μ΄μ € νλΌλ―Έν„° μ €μ¥
  - type='synth'μΌ λ• μ‚¬μ©

#### 2. `server/models/asset.js`
**μ¶”κ°€λ ν•„λ“**:
- `isRecorded` (BOOLEAN, DEFAULT FALSE)
  - λ§μ΄ν¬ λ…Ήμ μ—¬λ¶€ κµ¬λ¶„
  - TRUE: λ…Ήμ νμΌ, FALSE: μ—…λ΅λ“ νμΌ

#### 3. `server/models/preset.js`
**μ¶”κ°€λ ν•„λ“**:
- `masterVolume` (FLOAT, DEFAULT 0.7)
  - μ „μ²΄ λ§μ¤ν„° λ³Όλ¥¨ (0.0 ~ 1.0)
- `isQuantized` (BOOLEAN, DEFAULT TRUE)
  - ν€€νƒ€μ΄μ¦ ν™μ„±ν™” μ—¬λ¶€

---

### Step 2: API λΌμ°νΈ μμ •

#### 1. `server/routes/presets.js`
**λ³€κ²½ μ‚¬ν•­**:
- POST `/presets`: 
  - `masterVolume`, `isQuantized` νλΌλ―Έν„° μ²λ¦¬
  - `synthSettings` ν•„λ“ μ²λ¦¬ (mappings λ°°μ—΄)
  - `note` ν•„λ“ μ²λ¦¬ μ¶”κ°€

#### 2. `server/routes/upload.js`
**λ³€κ²½ μ‚¬ν•­**:
- POST `/upload`:
  - `isRecorded` νλΌλ―Έν„° μ²λ¦¬
  - μ”μ²­ λ³Έλ¬Έμ—μ„ `isRecorded` κ°’ μ½κΈ°

---

### Step 3: ν”„λ΅ νΈμ—”λ“ μ½”λ“ μ—…λ°μ΄νΈ

#### 1. `client/src/App.jsx`
**λ³€κ²½ μ‚¬ν•­**:
- `handleSave`: ν–¥ν›„ ν™•μ¥ κ°€λ¥μ„± μ£Όμ„ μ¶”κ°€
- `handleLoad`: μƒ ν•„λ“ λ΅λ“ μ£Όμ„ μ¶”κ°€

#### 2. `client/src/api/presets.js`
**λ³€κ²½ μ‚¬ν•­**:
- `savePreset`: μƒ ν•„λ“ νλΌλ―Έν„° μ£Όμ„ μ¶”κ°€

---

## π“ μ¶”κ°€λ ν•„λ“ μ”μ•½

| ν…μ΄λΈ” | ν•„λ“λ… | νƒ€μ… | κΈ°λ³Έκ°’ | μ„¤λ… |
|--------|--------|------|--------|------|
| Presets | `masterVolume` | FLOAT | 0.7 | μ „μ²΄ λ§μ¤ν„° λ³Όλ¥¨ |
| Presets | `isQuantized` | BOOLEAN | TRUE | ν€€νƒ€μ΄μ¦ ν™μ„±ν™” μ—¬λ¶€ |
| KeyMappings | `synthSettings` | JSON | NULL | μ‹ μ„μ‚¬μ΄μ € νλΌλ―Έν„° |
| Assets | `isRecorded` | BOOLEAN | FALSE | λ…Ήμ νμΌ μ—¬λ¶€ |

---

## π”„ ν•μ„ νΈν™μ„±

### β… κΈ°μ΅΄ μ½”λ“ μ •μƒ μ‘λ™
- μƒ ν•„λ“λ” λ¨λ‘ nullable λλ” κΈ°λ³Έκ°’ μ„¤μ •
- κΈ°μ΅΄ API νΈμ¶μ€ κΈ°λ³Έκ°’μΌλ΅ μ²λ¦¬λμ–΄ μ •μƒ μ‘λ™
- ν”„λ΅ νΈμ—”λ“ μ½”λ“λ” λ³€κ²½ μ—†μ΄ μ‘λ™ (μƒ ν•„λ“λ” μ„ νƒμ )

### β οΈ λ°μ΄ν„°λ² μ΄μ¤ λ§μ΄κ·Έλ μ΄μ…
- Sequelize `sync: true` μµμ… μ‚¬μ© μ‹ μλ™μΌλ΅ ν…μ΄λΈ” μ—…λ°μ΄νΈ
- κΈ°μ΅΄ λ°μ΄ν„°λ” κΈ°λ³Έκ°’μΌλ΅ μ±„μ›μ§
- λ§μ΄κ·Έλ μ΄μ… μ¤ν¬λ¦½νΈ μ‘μ„± κ¶μ¥ (ν”„λ΅λ•μ… ν™κ²½)

---

## π“ λ‹¤μ λ‹¨κ³„

### μ¦‰μ‹ κ°€λ¥ν• μ‘μ—…
1. **λ°μ΄ν„°λ² μ΄μ¤ λ§μ΄κ·Έλ μ΄μ… ν…μ¤νΈ**
   - κ°λ° ν™κ²½μ—μ„ Sequelize sync ν…μ¤νΈ
   - κΈ°μ΅΄ λ°μ΄ν„° μ •μƒ μ‘λ™ ν™•μΈ

2. **API ν…μ¤νΈ**
   - μƒ ν•„λ“λ¥Ό ν¬ν•¨ν• ν”„λ¦¬μ…‹ μ €μ¥/λ΅λ“ ν…μ¤νΈ
   - `isRecorded` ν•„λ“λ¥Ό ν¬ν•¨ν• νμΌ μ—…λ΅λ“ ν…μ¤νΈ

### ν–¥ν›„ μ‘μ—… (High-Fi λ΅λ“λ§µ)
1. **ν”„λ΅ νΈμ—”λ“μ—μ„ μƒ ν•„λ“ ν™μ©**
   - `synthSettings` μ‚¬μ©ν•μ—¬ ν¨λ“λ³„ μ‹ μ¤ μ„¤μ • μ €μ¥/λ΅λ“
   - `isRecorded`λ΅ λ…Ήμ νμΌκ³Ό μ—…λ΅λ“ νμΌ κµ¬λ¶„
   - `masterVolume`, `isQuantized`λ΅ ν”„λ¦¬μ…‹λ³„ μ„¤μ • μ €μ¥/λ΅λ“

2. **UI κµ¬ν„**
   - μ‹ μ¤ μ„¤μ • UI κ°μ„ 
   - λ…Ήμ νμΌ ν‘μ‹ κµ¬λ¶„
   - ν”„λ¦¬μ…‹λ³„ λ§μ¤ν„° λ³Όλ¥¨/ν€€νƒ€μ΄μ¦ μ„¤μ • UI

---

## π― μ™„λ£ μƒνƒ

- β… λ¨λΈ νμΌ μμ • μ™„λ£
- β… API λΌμ°νΈ μμ • μ™„λ£
- β… ν”„λ΅ νΈμ—”λ“ μ£Όμ„ μ¶”κ°€ μ™„λ£
- β… ν•μ„ νΈν™μ„± μ μ§€ μ™„λ£

**Phase 4 μ „μ²΄ μ™„λ£** β…
